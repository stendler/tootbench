# This is a sample configuration file. You can generate your configuration
# with the `rake mastodon:setup` interactive setup wizard, but to customize
# your setup even further, you'll need to edit it manually. This sample does
# not demonstrate all available configuration options. Please look at
# https://docs.joinmastodon.org/admin/config/ for the full documentation.

# Note that this file accepts slightly different syntax depending on whether
# you are using `docker-compose` or not. In particular, if you use
# `docker-compose`, the value of each declared variable will be taken verbatim,
# including surrounding quotes.
# See: https://github.com/mastodon/mastodon/issues/16895

# Federation
# ----------
# This identifies your server and cannot be changed safely later
# ----------
LOCAL_DOMAIN={{ inventory_hostname }}
#WEB_DOMAIN={{ hostvars[inventory_hostname].IP }}
ALTERNATE_DOMAINS={{ hostvars[inventory_hostname].IP }}
#AUTHORIZED_FETCH=true
#LIMITED_FEDERATION_MODE=true
#SINGLE_USER_MODE=true
# allow communication within google compute subnet
ALLOWED_PRIVATE_ADDRESSES=10.0.0.0/8,fe80::/10

TRUSTED_PROXY_IP=127.0.0.1 # should be nginx (container host name) but is not accepted

# PostgreSQL
# ----------
DB_HOST=db
DB_USER=postgres
DB_NAME=mastodon

# Redis
# -----
REDIS_HOST=redis

# Elasticsearch
ES_ENABLED=true
ES_HOST=es
ES_PORT=9200

# Secrets
# -------
# Make sure to use `rake secret` to generate secrets
# -------
SECRET_KEY_BASE={{ hostvars[inventory_hostname].RAKE_SECRET_KEY }}
OTP_SECRET={{ hostvars[inventory_hostname].RAKE_SECRET_OTP }}

# Web Push
# --------
# Generate with `rake mastodon:webpush:generate_vapid_key`
# --------
VAPID_PRIVATE_KEY={{ hostvars[inventory_hostname].VAPID_PRIVATE_KEY }}
VAPID_PUBLIC_KEY={{ hostvars[inventory_hostname].VAPID_PUBLIC_KEY }}

# Sending mail
# ------------
#SMTP_SERVER=localhost
#SMTP_PORT=25
#SMTP_LOGIN=
#SMTP_PASSWORD=
#SMTP_FROM_ADDRESS=notifications@example.com

# IP and session retention
# -----------------------
# Make sure to modify the scheduling of ip_cleanup_scheduler in config/sidekiq.yml
# to be less than daily if you lower IP_RETENTION_PERIOD below two days (172800).
# -----------------------
IP_RETENTION_PERIOD=31556952
SESSION_RETENTION_PERIOD=31556952
